# BabyBilling

## Описание

Проект состоит из двух микросервисов:

- **CDR Generator** — сервис, генерирующий случайные записи звонков (CDR)
- **BRT (Billing Real-Time)** — микросервис, принимающий данные через RabbitMQ и сохраняющий их в PostgreSQL
- **HRS** — микросервис, принимающий данные через REST API и проводящий тарификацию абонента

## Работа системы

### POST /generate/random

Эндпоинт доступен в CDR Generator.  
При вызове:

- Генерируется случайное количество записей звонков
- Записи сериализуются в формате JSON
- Отправляются через RabbitMQ в очередь, слушаемую микросервисом BRT

### BRT

Микросервис BRT:

- Принимает записи из RabbitMQ
- Проверяет наличие вызывающего абонента в таблице `subscribers`
- Сохраняет валидные записи в таблицу `romashka_calls_info` в базе PostgreSQL
- Отправляет данные в HRS для тарификации
- Принимает данные DTO-ответ из HRS и обновляет баланс (деньги/минуты)

- ### HRS

Микросервис HRS:

- Принимает данные из BRT по REST API
- Проводит тарификацию в зависимости от тарифа абонента
- Возвращает DTO-ответ в BRT

## Хранение данных

- Основная база данных — **PostgreSQL**

## Liquibase

Проект использует **Liquibase** для управления схемой базы данных.

- При первом запуске автоматически создаются все необходимые таблицы

## Используемые технологии

- Java 17
- Spring Boot
- Spring Data JPA
- RabbitMQ
- PostgreSQL
- Liquibase
- H2

